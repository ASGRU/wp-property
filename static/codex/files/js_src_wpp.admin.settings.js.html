<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>js/src/wpp.admin.settings.js - usabilitydynamics/wp-property</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="usabilitydynamics/wp-property"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 2.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/UsabilityDynamics\WPP.Bootstrap.html">UsabilityDynamics\WPP.Bootstrap</a></li>
            
                <li><a href="../classes/UsabilityDynamics\WPP.Loader.html">UsabilityDynamics\WPP.Loader</a></li>
            
                <li><a href="../classes/UsabilityDynamics\WPP.WPP.html">UsabilityDynamics\WPP.WPP</a></li>
            
                <li><a href="../classes/wpp.html">wpp</a></li>
            
                <li><a href="../classes/wpp.overview.html">wpp.overview</a></li>
            
                <li><a href="../classes/wpp.ui.agents.html">wpp.ui.agents</a></li>
            
                <li><a href="../classes/wpp.ui.feps.html">wpp.ui.feps</a></li>
            
                <li><a href="../classes/wpp.ui.settings.html">wpp.ui.settings</a></li>
            
                <li><a href="../classes/wpp.xmli.html">wpp.xmli</a></li>
            
                <li><a href="../classes/wpp_default_api.html">wpp_default_api</a></li>
            
                <li><a href="../classes/WPP_UI.html">WPP_UI</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: js/src/wpp.admin.settings.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * WP-Property Admin Settings page
 *
 */
jQuery.extend( wpp = wpp || {}, { ui: { settings: {

  /**
   * Initialize DOM.
   *
   * @for wpp.ui.settings
   * @method ready
   */
  ready: function() {

    /**
     * Handles data saving.
     * Only if we don&#x27;t upload backup file!
     *
     * @author peshkov@UD
     */
    jQuery( &#x27;#wpp_settings_form&#x27; ).submit( function() {
      if( !jQuery( &#x27;#wpp_backup_file&#x27; ).val() ) {
        var btn = jQuery( &quot;input[type=&#x27;submit&#x27;]&quot; );
        btn.prop( &#x27;disabled&#x27;, true );
        var data = jQuery( this ).serialize();
        jQuery.ajax({
          type: &#x27;POST&#x27;,
          url: wpp.instance.ajax_url,
          data: {
            action: &#x27;wpp_save_settings&#x27;,
            data: data
          },
          success: function( response ){
            var data = jQuery.parseJSON( response );
            if( data.success ) {
              window.location.href = data.redirect;
            } else {
              alert( data.message );
              btn.prop( &#x27;disabled&#x27;, false );
            }
          },
          error: function() {
            alert( wpp.strings.undefined_error );
            btn.prop( &#x27;disabled&#x27;, false );
          }
        });
        return false;
      }
    } );

    /* Tabs for various UI elements */
    jQuery( &#x27;.wpp_subtle_tabs&#x27; ).tabs();

    wpp.ui.settings.setup_default_property_page();

    jQuery( &quot;#wpp_settings_base_slug&quot; ).change( function () {
      wpp.ui.settings.setup_default_property_page();
    } );

    if ( document.location.hash != &#x27;&#x27; &amp;&amp; jQuery( document.location.hash ).length &gt; 0 ) {
      jQuery( &quot;#wpp_settings_tabs&quot; ).tabs();
    } else {
      jQuery( &quot;#wpp_settings_tabs&quot; ).tabs( { cookie: {  name: &#x27;wpp_settings_tabs&#x27;, expires: 30 } } );
    }

    /* Show settings array */
    jQuery( &quot;#wpp_show_settings_array&quot; ).click( function () {
      jQuery( &quot;#wpp_show_settings_array_cancel&quot; ).show();
      jQuery( &quot;#wpp_show_settings_array_result&quot; ).show();
    } );

    /* Hide settings array */
    jQuery( &quot;#wpp_show_settings_array_cancel&quot; ).click( function () {
      jQuery( &quot;#wpp_show_settings_array_result&quot; ).hide();
      jQuery( this ).hide();
    } );

    /* Hide property query */
    jQuery( &quot;#wpp_ajax_property_query_cancel&quot; ).click( function () {
      jQuery( &quot;#wpp_ajax_property_result&quot; ).hide();
      jQuery( this ).hide();
    } );

    /* Hide image query */
    jQuery( &quot;#wpp_ajax_image_query_cancel&quot; ).click( function () {
      jQuery( &quot;#wpp_ajax_image_result&quot; ).hide();
      jQuery( this ).hide();
    } );

    /* Check plugin updates */
    jQuery( &quot;#wpp_ajax_check_plugin_updates&quot; ).click( function () {
      jQuery( &#x27;.plugin_status&#x27; ).remove();
      jQuery.post( wpp.instance.ajax_url, {
        action: &#x27;wpp_ajax_check_plugin_updates&#x27;
      }, function ( data ) {
        message = &quot;&lt;div class=&#x27;plugin_status updated fade&#x27;&gt;&lt;p&gt;&quot; + data + &quot;&lt;/p&gt;&lt;/div&gt;&quot;;
        jQuery( message ).insertAfter( &quot;h2&quot; );
      } );
    } );

    /* Clear Cache */
    jQuery( &quot;#wpp_clear_cache&quot; ).click( function () {
      jQuery( &#x27;.clear_cache_status&#x27; ).remove();
      jQuery.post( wpp.instance.ajax_url, {
        action: &#x27;wpp_ajax_clear_cache&#x27;
      }, function ( data ) {
        message = &quot;&lt;div class=&#x27;clear_cache_status updated fade&#x27;&gt;&lt;p&gt;&quot; + data + &quot;&lt;/p&gt;&lt;/div&gt;&quot;;
        jQuery( message ).insertAfter( &quot;h2&quot; );
      } );
    } );

    /* Revalidate all addresses */
    jQuery( &quot;#wpp_ajax_revalidate_all_addresses&quot; ).click( function () {
      jQuery( this ).val( wpp.strings.processing );
      jQuery( this ).attr( &#x27;disabled&#x27;, true );
      jQuery( &#x27;.address_revalidation_status&#x27; ).remove();

      jQuery.post( wpp.instance.ajax_url, {
        action: &#x27;wpp_ajax_revalidate_all_addresses&#x27;
      }, function ( data ) {
        jQuery( &quot;#wpp_ajax_revalidate_all_addresses&quot; ).val( &#x27;Revalidate again&#x27; );
        jQuery( &quot;#wpp_ajax_revalidate_all_addresses&quot; ).attr( &#x27;disabled&#x27;, false );
        var message = &#x27;&#x27;;
        if ( data.success == &#x27;true&#x27; ) {
          message = &quot;&lt;div class=&#x27;address_revalidation_status updated fade&#x27;&gt;&lt;p&gt;&quot; + data.message + &quot;&lt;/p&gt;&lt;/div&gt;&quot;;
        } else {
          message = &quot;&lt;div class=&#x27;address_revalidation_status error fade&#x27;&gt;&lt;p&gt;&quot; + data.message + &quot;&lt;/p&gt;&lt;/div&gt;&quot;;
        }
        jQuery( message ).insertAfter( &quot;h2&quot; );
      }, &#x27;json&#x27; );
    } );

    /* Show property query */
    jQuery( &quot;#wpp_ajax_property_query&quot; ).click( function () {
      var property_id = jQuery( &quot;#wpp_property_class_id&quot; ).val();
      jQuery( &quot;#wpp_ajax_property_result&quot; ).html( &quot;&quot; );

      jQuery.post( wpp.instance.ajax_url, {
        action: &#x27;wpp_ajax_property_query&#x27;,
        property_id: property_id
      }, function ( data ) {
        jQuery( &quot;#wpp_ajax_property_result&quot; ).show();
        jQuery( &quot;#wpp_ajax_property_result&quot; ).html( data );
        jQuery( &quot;#wpp_ajax_property_query_cancel&quot; ).show();
      } );
    } );

    //** Mass set property type */
    jQuery( &quot;#wpp_ajax_max_set_property_type&quot; ).click( function () {
      if ( !confirm( wpp.strings.set_property_type_confirmation ) ) {
        return;
      }
      jQuery.post( wpp.instance.ajax_url, {
        action: &#x27;wpp_ajax_max_set_property_type&#x27;,
        property_type: jQuery( &quot;#wpp_ajax_max_set_property_type_type&quot; ).val()
      }, function ( data ) {
        jQuery( &quot;#wpp_ajax_max_set_property_type_result&quot; ).show();
        jQuery( &quot;#wpp_ajax_max_set_property_type_result&quot; ).html( data );
      } );
    } );

    /* Show image data */
    jQuery( &quot;#wpp_ajax_image_query&quot; ).click( function () {
      var image_id = jQuery( &quot;#wpp_image_id&quot; ).val();
      jQuery( &quot;#wpp_ajax_image_result&quot; ).html( &quot;&quot; );

      jQuery.post( wpp.instance.ajax_url, {
        action: &#x27;wpp_ajax_image_query&#x27;,
        image_id: image_id
      }, function ( data ) {
        jQuery( &quot;#wpp_ajax_image_result&quot; ).show();
        jQuery( &quot;#wpp_ajax_image_result&quot; ).html( data );
        jQuery( &quot;#wpp_ajax_image_query_cancel&quot; ).show();
      } );
    } );

    /** Show property query */
    jQuery( &quot;#wpp_check_premium_updates&quot; ).click( function () {
      jQuery( &quot;#wpp_plugins_ajax_response&quot; ).hide();
      jQuery.post( wpp.instance.ajax_url, {
        action: &#x27;wpp_ajax_check_plugin_updates&#x27;
      }, function ( data ) {
        jQuery( &quot;#wpp_plugins_ajax_response&quot; ).show();
        jQuery( &quot;#wpp_plugins_ajax_response&quot; ).html( data );
      } );
    } );

  },

  /**
   * Modifies UI to reflect Default Property Page selection
   *
   * @for wpp.ui.settings
   * @method setup_default_property_page
   */
  setup_default_property_page: function() {
    var selection = jQuery( &quot;#wpp_settings_base_slug&quot; ).val();
    /* Default Property Page is dynamic. */
    if ( selection == &quot;property&quot; ) {
      jQuery( &quot;.wpp_non_property_page_settings&quot; ).hide();
      jQuery( &quot;.wpp_non_property_page_settings input[type=checkbox]&quot; ).attr( &quot;checked&quot;, false );
      jQuery( &quot;.wpp_non_property_page_settings input[type=checkbox]&quot; ).attr( &quot;disabled&quot;, true );
    } else {
      jQuery( &quot;.wpp_non_property_page_settings&quot; ).show();
      jQuery( &quot;.wpp_non_property_page_settings input[type=checkbox]&quot; ).attr( &quot;disabled&quot;, false );
    }
  }

}}});

// Initialize Overview.
jQuery( document ).ready( wpp.ui.settings.ready );
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
