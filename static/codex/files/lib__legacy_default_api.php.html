<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>lib/_legacy/default_api.php - usabilitydynamics/wp-property</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="usabilitydynamics/wp-property"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 2.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/UsabilityDynamics\WPP.Bootstrap.html">UsabilityDynamics\WPP.Bootstrap</a></li>
            
                <li><a href="../classes/UsabilityDynamics\WPP.Loader.html">UsabilityDynamics\WPP.Loader</a></li>
            
                <li><a href="../classes/UsabilityDynamics\WPP.WPP.html">UsabilityDynamics\WPP.WPP</a></li>
            
                <li><a href="../classes/wpp.html">wpp</a></li>
            
                <li><a href="../classes/wpp.overview.html">wpp.overview</a></li>
            
                <li><a href="../classes/wpp.ui.agents.html">wpp.ui.agents</a></li>
            
                <li><a href="../classes/wpp.ui.feps.html">wpp.ui.feps</a></li>
            
                <li><a href="../classes/wpp.ui.settings.html">wpp.ui.settings</a></li>
            
                <li><a href="../classes/wpp.xmli.html">wpp.xmli</a></li>
            
                <li><a href="../classes/wpp_default_api.html">wpp_default_api</a></li>
            
                <li><a href="../classes/WPP_UI.html">WPP_UI</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: lib/_legacy/default_api.php</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&lt;?php
/**
 * Default API Usage Examples
 *
 * @since 0.0.1
 * @class wpp_default_api
 */
class wpp_default_api {

  /**
   * Loader for WPP API functions.
   *
   * @version 1.25.0
   */
  static function plugins_loaded() {

    //** Load API towards the end of init */
    add_filter( &#x27;init&#x27;, array( &#x27;wpp_default_api&#x27;, &#x27;init&#x27; ), 0, 30 );

  }

  /**
   * Loader for WPP API functions.
   *
   * @version 1.25.0
   */
  static function init() {
    global $shortcode_tags;

    $shortcodes = array_keys( (array) $shortcode_tags );

    //** Load list-attachments shortcode if the List Attachments Shortcode plugin does not exist */
    if( !in_array( &#x27;list-attachments&#x27;, $shortcodes ) ) {
      add_shortcode( &#x27;list_attachments&#x27;, array( &#x27;wpp_default_api&#x27;, &#x27;list_attachments&#x27; ) );
    }

  }

  /**
   * Display list of attached files to a s post.
   *
   * Function ported over from List Attachments Shortcode plugin.
   *
   * @version 1.25.0
   */
  static function list_attachments( $atts = array() ) {
    global $post, $wp_query;

    $r = &#x27;&#x27;;

    if( !is_array( $atts ) ) {
      $atts = array();
    }

    $defaults = array(
      &#x27;type&#x27;                 =&gt; NULL,
      &#x27;orderby&#x27;              =&gt; NULL,
      &#x27;groupby&#x27;              =&gt; NULL,
      &#x27;order&#x27;                =&gt; NULL,
      &#x27;post_id&#x27;              =&gt; false,
      &#x27;before_list&#x27;          =&gt; &#x27;&#x27;,
      &#x27;after_list&#x27;           =&gt; &#x27;&#x27;,
      &#x27;opening&#x27;              =&gt; &#x27;&lt;ul class=&quot;attachment-list wpp_attachment_list&quot;&gt;&#x27;,
      &#x27;closing&#x27;              =&gt; &#x27;&lt;/ul&gt;&#x27;,
      &#x27;before_item&#x27;          =&gt; &#x27;&lt;li&gt;&#x27;,
      &#x27;after_item&#x27;           =&gt; &#x27;&lt;/li&gt;&#x27;,
      &#x27;show_descriptions&#x27;    =&gt; true,
      &#x27;include_icon_classes&#x27; =&gt; true,
      &#x27;showsize&#x27;             =&gt; false
    );

    $atts = array_merge( $defaults, $atts );

    if( isset( $atts[ &#x27;post_id&#x27; ] ) &amp;&amp; is_numeric( $atts[ &#x27;post_id&#x27; ] ) ) {
      $post = get_post( $atts[ &#x27;post_id&#x27; ] );
    }

    if( !$post ) {
      return;
    }

    if( !empty( $atts[ &#x27;type&#x27; ] ) ) {
      $types = explode( &#x27;,&#x27;, str_replace( &#x27; &#x27;, &#x27;&#x27;, $atts[ &#x27;type&#x27; ] ) );
    } else {
      $types = array();
    }

    $showsize   = ( $atts[ &#x27;showsize&#x27; ] == true || $atts[ &#x27;showsize&#x27; ] == &#x27;true&#x27; || $atts[ &#x27;showsize&#x27; ] == 1 ) ? true : false;
    $upload_dir = wp_upload_dir();

    $op = clone $post;
    $oq = clone $wp_query;

    foreach( array( &#x27;before_list&#x27;, &#x27;after_list&#x27;, &#x27;opening&#x27;, &#x27;closing&#x27;, &#x27;before_item&#x27;, &#x27;after_item&#x27; ) as $htmlItem ) {
      $atts[ $htmlItem ] = str_replace( array( &#x27;&amp;lt;&#x27;, &#x27;&amp;gt;&#x27; ), array( &#x27;&lt;&#x27;, &#x27;&gt;&#x27; ), $atts[ $htmlItem ] );
    }

    $args = array(
      &#x27;post_type&#x27;   =&gt; &#x27;attachment&#x27;,
      &#x27;numberposts&#x27; =&gt; -1,
      &#x27;post_status&#x27; =&gt; null,
      &#x27;post_parent&#x27; =&gt; $post-&gt;ID,
    );

    if( !empty( $atts[ &#x27;orderby&#x27; ] ) ) {
      $args[ &#x27;orderby&#x27; ] = $atts[ &#x27;orderby&#x27; ];
    }
    if( !empty( $atts[ &#x27;order&#x27; ] ) ) {
      $atts[ &#x27;order&#x27; ] = ( in_array( $atts[ &#x27;order&#x27; ], array( &#x27;a&#x27;, &#x27;asc&#x27;, &#x27;ascending&#x27; ) ) ) ? &#x27;asc&#x27; : &#x27;desc&#x27;;
      $args[ &#x27;order&#x27; ] = $atts[ &#x27;order&#x27; ];
    }
    if( !empty( $atts[ &#x27;groupby&#x27; ] ) ) {
      $args[ &#x27;orderby&#x27; ] = $atts[ &#x27;groupby&#x27; ];
    }

    $attachments = get_posts( $args );

    if( $attachments ) {
      $grouper = $atts[ &#x27;groupby&#x27; ];
      $test    = $attachments;
      $test    = array_shift( $test );
      if( !property_exists( $test, $grouper ) ) {
        $grouper = &#x27;post_&#x27; . $grouper;
      }

      $attlist = array();

      foreach( $attachments as $att ) {
        $key = ( !empty( $atts[ &#x27;groupby&#x27; ] ) ) ? $att-&gt;$grouper : $att-&gt;ID;
        $key .= ( !empty( $atts[ &#x27;orderby&#x27; ] ) ) ? $att-&gt;$atts[ &#x27;orderby&#x27; ] : &#x27;&#x27;;

        $attlink = wp_get_attachment_url( $att-&gt;ID );

        if( count( $types ) ) {
          foreach( $types as $t ) {
            if( substr( $attlink, ( 0 - strlen( &#x27;.&#x27; . $t ) ) ) == &#x27;.&#x27; . $t ) {
              $attlist[ $key ]          = clone $att;
              $attlist[ $key ]-&gt;attlink = $attlink;
            }
          }
        } else {
          $attlist[ $key ]          = clone $att;
          $attlist[ $key ]-&gt;attlink = $attlink;
        }
      }
      if( $atts[ &#x27;groupby&#x27; ] ) {
        if( $atts[ &#x27;order&#x27; ] == &#x27;asc&#x27; ) {
          ksort( $attlist );
        } else {
          krsort( $attlist );
        }
      }
    }

    if( count( $attlist ) ) {
      $open = false;
      $r    = $atts[ &#x27;before_list&#x27; ] . $atts[ &#x27;opening&#x27; ];
      foreach( $attlist as $att ) {

        $container_classes = array( &#x27;attachment_container&#x27; );

        //** Determine class to display for this file type */
        if( $atts[ &#x27;include_icon_classes&#x27; ] ) {

          switch( $att-&gt;post_mime_type ) {

            case &#x27;application/zip&#x27;:
              $class = &#x27;zip&#x27;;
              break;

            case &#x27;vnd.ms-excel&#x27;:
              $class = &#x27;excel&#x27;;
              break;

            case &#x27;image/jpeg&#x27;:
            case &#x27;image/png&#x27;:
            case &#x27;image/gif&#x27;:
            case &#x27;image/bmp&#x27;:
              $class = &#x27;image&#x27;;
              break;

            default:
              $class = &#x27;default&#x27;;
              break;
          }
        }

        $icon_class = ( $class ? &#x27;wpp_attachment_icon file-&#x27; . $class : false );

        //** Determine if description shuold be displayed, and if it is not empty */
        $echo_description = ( $atts[ &#x27;show_descriptions&#x27; ] &amp;&amp; !empty( $att-&gt;post_content ) ? &#x27; &lt;span class=&quot;attachment_description&quot;&gt; &#x27; . $att-&gt;post_content . &#x27; &lt;/span&gt; &#x27; : false );

        $echo_title = ( $att-&gt;post_excerpt ? $att-&gt;post_excerpt : __( &#x27;View &#x27;, &#x27;wpp&#x27; ) . apply_filters( &#x27;the_title_attribute&#x27;, $att-&gt;post_title ) );

        if( $icon_class ) {
          $container_classes[ ] = &#x27;has_icon&#x27;;
        }

        if( !empty( $echo_description ) ) {
          $container_classes[ ] = &#x27;has_description&#x27;;
        }

        //** Add conditional classes if class is not already passed into container */
        if( !strpos( $atts[ &#x27;before_item&#x27; ], &#x27;class&#x27; ) ) {
          $this_before_item = str_replace( &#x27;&gt;&#x27;, &#x27; class=&quot;&#x27; . implode( &#x27; &#x27;, $container_classes ) . &#x27;&quot;&gt;&#x27;, $atts[ &#x27;before_item&#x27; ] );
        }

        $echo_size = ( ( $showsize ) ? &#x27; &lt;span class=&quot;attachment-size&quot;&gt;&#x27; . Utility::get_filesize( str_replace( $upload_dir[ &#x27;baseurl&#x27; ], $upload_dir[ &#x27;basedir&#x27; ], $attlink ) ) . &#x27;&lt;/span&gt;&#x27; : &#x27;&#x27; );

        if( !empty( $atts[ &#x27;groupby&#x27; ] ) &amp;&amp; $current_group != $att-&gt;$grouper ) {
          if( $open ) {
            $r .= $atts[ &#x27;closing&#x27; ] . $atts[ &#x27;after_item&#x27; ];
            $open = false;
          }
          $r .= $atts[ &#x27;before_item&#x27; ] . &#x27;&lt;h3&gt;&#x27; . $att-&gt;$grouper . &#x27;&lt;/h3&gt;&#x27; . $atts[ &#x27;opening&#x27; ];
          $open          = true;
          $current_group = $att-&gt;$grouper;
        }
        $attlink = $att-&gt;attlink;
        $r .= $this_before_item . &#x27;&lt;a href=&quot;&#x27; . $attlink . &#x27;&quot; title=&quot;&#x27; . $echo_title . &#x27;&quot; class=&quot;wpp_attachment &#x27; . $icon_class . &#x27;&quot;&gt;&#x27; . apply_filters( &#x27;the_title&#x27;, $att-&gt;post_title ) . &#x27;&lt;/a&gt;&#x27; . $echo_size . $echo_description . $atts[ &#x27;after_item&#x27; ];
      }
      if( $open ) {
        $r .= $atts[ &#x27;closing&#x27; ] . $atts[ &#x27;after_item&#x27; ];
      }
      $r .= $atts[ &#x27;closing&#x27; ] . $atts[ &#x27;after_list&#x27; ];
    }

    $wp_query = clone $oq;
    $post     = clone $op;

    return $r;

  }

}

// Initialize WPP Default API */
add_filter( &#x27;plugins_loaded&#x27;, array( &#x27;wpp_default_api&#x27;, &#x27;plugins_loaded&#x27; ), 0, 9 );

// Widget address format
add_filter( &quot;wpp_stat_filter_{$wp_properties[ &#x27;configuration&#x27; ][&#x27;address_attribute&#x27;]}&quot;, &quot;wpp_format_address_attribute&quot;, 0, 3 );

// Add additional Google Maps localizations
add_filter( &quot;wpp_google_maps_localizations&quot;, &quot;wpp_add_additional_google_maps_localizations&quot; );

// Add post-thumbnails support
add_action( &quot;after_setup_theme&quot;, array( &#x27;WPP_Core&#x27;, &quot;after_setup_theme&quot; ) );

// Add some default actions
//add_filter(&quot;wpp_stat_filter_price&quot;, &#x27;add_dollar_sign&#x27;);
//add_filter(&quot;wpp_stat_filter_deposit&quot;, &#x27;add_dollar_sign&#x27;);

//** Add dollar sign to all attributes marked as currency */
if( isset( $wp_properties[ &#x27;currency_attributes&#x27; ] ) &amp;&amp; is_array( $wp_properties[ &#x27;currency_attributes&#x27; ] ) ) {
  foreach( $wp_properties[ &#x27;currency_attributes&#x27; ] as $attribute ) {
    add_filter( &quot;wpp_stat_filter_{$attribute}&quot;, &#x27;add_dollar_sign&#x27; );
  }
}

//** Format values as numeric if marked as numeric_attributes */
if( isset( $wp_properties[ &#x27;numeric_attributes&#x27; ] ) &amp;&amp; is_array( $wp_properties[ &#x27;numeric_attributes&#x27; ] ) ) {
  foreach( $wp_properties[ &#x27;numeric_attributes&#x27; ] as $attribute ) {
    add_filter( &quot;wpp_stat_filter_{$attribute}&quot;, array( &#x27;WPP_F&#x27;, &#x27;format_numeric&#x27; ) );
  }

  if( in_array( &#x27;area&#x27;, $wp_properties[ &#x27;numeric_attributes&#x27; ] ) ) {
    add_filter( &quot;wpp_stat_filter_area&quot;, &#x27;add_square_foot&#x27; );
  }
}

//** Format values for checkboxes */
if( isset( $wp_properties[ &#x27;searchable_attr_fields&#x27; ] ) &amp;&amp; is_array( $wp_properties[ &#x27;searchable_attr_fields&#x27; ] ) ) {
  foreach( $wp_properties[ &#x27;searchable_attr_fields&#x27; ] as $key =&gt; $value ) {
    if( $value == &#x27;checkbox&#x27; ) {
      add_filter( &quot;wpp_stat_filter_$key&quot;, create_function( &#x27; $value &#x27;, &#x27; return $value == &quot;0&quot; ? __(&quot;No&quot;, &quot;wpp&quot;) : __(&quot;Yes&quot;, &quot;wpp&quot;); &#x27; ) );
    }
  }
}

add_filter( &quot;wpp_stat_filter_phone_number&quot;, &#x27;format_phone_number&#x27; );

// Exclude hidden attributes from frontend
add_filter( &#x27;wpp_get_property&#x27;, &#x27;wpp_exclude_hidden_attributes&#x27; );

add_filter( &#x27;wpp_get_property&#x27;, &#x27;add_display_address&#x27; );

add_filter( &#x27;wpp_property_inheritance&#x27;, &#x27;add_city_to_inheritance&#x27; );
add_filter( &#x27;wpp_searchable_attributes&#x27;, &#x27;add_city_to_searchable&#x27; );

add_filter( &#x27;wpp_property_stat_labels&#x27;, &#x27;wpp_unique_key_labels&#x27;, 20 );

add_filter( &#x27;the_password_form&#x27;, &#x27;wpp_password_protected_property_form&#x27; );

// Coordinate manual override
add_filter( &#x27;wpp_property_stats_input_&#x27; . $wp_properties[ &#x27;configuration&#x27; ][ &#x27;address_attribute&#x27; ], &#x27;wpp_property_stats_input_address&#x27;, 0, 3 );

add_action( &#x27;save_property&#x27;, &#x27;wpp_save_property_aggregated_data&#x27; );

//add_action(&quot;wpp_ui_after_attribute_{$wp_properties[&#x27;configuration&#x27;][&#x27;address_attribute&#x27;]}&quot;, &#x27;wpp_show_coords&#x27;);
add_action( &#x27;wpp_ui_after_attribute_price&#x27;, &#x27;wpp_show_week_month_selection&#x27; );

//**  Adds additional settings for Property Page */
add_action( &#x27;wpp_settings_page_property_page&#x27;, &#x27;add_format_phone_number_checkbox&#x27; );

/**
 * Add labels to system-generated attributes that do not have custom-set values
 *
 * @since 1.22.0
 */
function wpp_unique_key_labels( $stats ) {

  if( empty( $stats[ &#x27;property_type&#x27; ] ) ) {
    $stats[ &#x27;property_type&#x27; ] = sprintf( __( &#x27;%1s Type&#x27;, &#x27;wpp&#x27; ), Utility::property_label( &#x27;singular&#x27; ) );
  }

  if( empty( $stats[ &#x27;city&#x27; ] ) ) {
    $stats[ &#x27;city&#x27; ] = __( &#x27;City&#x27;, &#x27;wpp&#x27; );
  }

  return $stats;

}

function wpp_password_protected_property_form( $output ) {
  global $post;

  if( $post-&gt;post_type != &#x27;property&#x27; )
    return $output;

  return str_replace( &quot;This post is password protected&quot;, &quot;This property is password protected&quot;, $output );
}

/**
 * Example of how to add a new language to Google Maps localization
 *
 * @since 1.04
 */
function wpp_add_additional_google_maps_localizations( $attributes ) {
  $attributes[ &#x27;fi&#x27; ] = &quot;Finnish&quot;;

  return $attributes;
}

/**
 * Formats address on print.  If address it not formatted, makes an on-the-fly call to GMaps for validation.
 *
 *
 * @since 1.04
 */
function wpp_format_address_attribute( $data, $property = false, $format = &quot;[street_number] [street_name], [city], [state]&quot; ) {
  global $wp_properties;

  if( !is_object( $property ) ) {
    return $data;
  }

  $currenty_address = $property-&gt;$wp_properties[ &#x27;configuration&#x27; ][ &#x27;address_attribute&#x27; ];

  //** If the currently requested properties address has not been formatted, and on-the-fly geo-lookup has not been disabled, try to look up now */
  if( !$property-&gt;address_is_formatted &amp;&amp; $wp_properties[ &#x27;configuration&#x27; ][ &#x27;do_not_automatically_geo_validate_on_property_view&#x27; ] != &#x27;true&#x27; ) {
    //** Silently attempt to validate address, right now */
    $geo_data = Utility::revalidate_all_addresses( array( &#x27;property_ids&#x27; =&gt; array( $property-&gt;ID ), &#x27;echo_result&#x27; =&gt; false, &#x27;return_geo_data&#x27; =&gt; true ) );

    if( $this_geo_data = $geo_data[ &#x27;geo_data&#x27; ][ $property-&gt;ID ] ) {

      $street_number = $this_geo_data-&gt;street_number;
      $route         = $this_geo_data-&gt;route;
      $city          = $this_geo_data-&gt;city;
      $state         = $this_geo_data-&gt;state;
      $state_code    = $this_geo_data-&gt;state_code;
      $county        = $this_geo_data-&gt;county;
      $country       = $this_geo_data-&gt;country;
      $postal_code   = $this_geo_data-&gt;postal_code;
    }

  } else {

    $street_number = $property-&gt;street_number;
    $route         = $property-&gt;route;
    $city          = $property-&gt;city;
    $state         = $property-&gt;state;
    $state_code    = $property-&gt;state_code;
    $county        = $property-&gt;county;
    $country       = $property-&gt;country;
    $postal_code   = $property-&gt;postal_code;
  }

  $display_address = $format;

  $display_address = str_replace( &quot;[street_number]&quot;, $street_number, $display_address );
  $display_address = str_replace( &quot;[street_name]&quot;, $route, $display_address );
  $display_address = str_replace( &quot;[city]&quot;, &quot;$city&quot;, $display_address );
  $display_address = str_replace( &quot;[state]&quot;, &quot;$state&quot;, $display_address );
  $display_address = str_replace( &quot;[state_code]&quot;, &quot;$state_code&quot;, $display_address );
  $display_address = str_replace( &quot;[county]&quot;, &quot;$county&quot;, $display_address );
  $display_address = str_replace( &quot;[country]&quot;, &quot;$country&quot;, $display_address );
  $display_address = str_replace( &quot;[zip_code]&quot;, &quot;$postal_code&quot;, $display_address );
  $display_address = str_replace( &quot;[zip]&quot;, &quot;$postal_code&quot;, $display_address );
  $display_address = str_replace( &quot;[postal_code]&quot;, &quot;$postal_code&quot;, $display_address );
  $display_address = preg_replace( &#x27;/^\n+|^[\t\s]*\n+/m&#x27;, &quot;&quot;, $display_address );

  if( str_replace( &#x27; &#x27;, &#x27;,&#x27;, &#x27;&#x27;, $display_address ) == &#x27;&#x27; ) {

    if( !empty( $currenty_address ) ) {
      return $currenty_address;
    } else {
      return;
    }

  }

  // Remove empty lines
  foreach( explode( &quot;\n&quot;, $display_address ) as $line ) {

    $line = trim( $line );

    // Remove line if comma is first character
    if( strlen( $line ) &lt; 3 &amp;&amp; ( strpos( $line, &#x27;,&#x27; ) === 1 || strpos( $line, &#x27;,&#x27; ) === 0 ) ) {
      continue;
    }

    $return[ ] = $line;

  }

  if( is_array( $return ) ) {
    return implode( &quot;\n&quot;, $return );
  }

}

function wpp_property_stats_add_sold_or_rented( $property_stats ) {

  $property_stats[ &#x27;for_sale&#x27; ] = __( &quot;For Sale&quot;, &#x27;wpp&#x27; );
  $property_stats[ &#x27;for_rent&#x27; ] = __( &quot;For Rent&quot;, &#x27;wpp&#x27; );

  return $property_stats;
}

function wpp_property_stats_input_for_rent_make_checkbox( $content, $slug, $object ) {
  $checked = ( $object[ $slug ] == &#x27;true&#x27; ? &#x27; checked=&quot;true&quot; &#x27; : false );

  return &quot;&lt;input type=&#x27;hidden&#x27; name=&#x27;wpp_data[meta][{$slug}]&#x27;  value=&#x27;false&#x27;  /&gt;&lt;input type=&#x27;checkbox&#x27; id=&#x27;wpp_meta_{$slug}&#x27; name=&#x27;wpp_data[meta][{$slug}]&#x27;  value=&#x27;true&#x27; $checked /&gt; &lt;label for=&#x27;wpp_meta_{$slug}&#x27;&gt;&quot; . __( &#x27;This is a rental property.&#x27;, &#x27;wpp&#x27; ) . &quot;&lt;/label&gt;&quot;;
}

function wpp_property_stats_input_for_sale_make_checkbox( $content, $slug, $object ) {
  $checked = ( $object[ $slug ] == &#x27;true&#x27; ? &#x27; checked=&quot;true&quot; &#x27; : false );

  return &quot;&lt;input type=&#x27;hidden&#x27;  name=&#x27;wpp_data[meta][{$slug}]&#x27;  value=&#x27;false&#x27; /&gt;&lt;input type=&#x27;checkbox&#x27; id=&#x27;wpp_meta_{$slug}&#x27; name=&#x27;wpp_data[meta][{$slug}]&#x27;  value=&#x27;true&#x27; $checked /&gt; &lt;label for=&#x27;wpp_meta_{$slug}&#x27;&gt;&quot; . __( &#x27;This property is for sale.&#x27;, &#x27;wpp&#x27; ) . &quot;&lt;/label&gt;&quot;;
}

/**
 * Add UI to set custom coordinates on property editing page
 *
 * @since 1.04
 */
function wpp_property_stats_input_address( $content, $slug, $object ) {

  ob_start();

  ?&gt;
  &lt;div class=&quot;wpp_attribute_row_address&quot;&gt;
          &lt;?php echo $content; ?&gt;
    &lt;div class=&quot;wpp_attribute_row_address_options&quot;&gt;
          &lt;input type=&quot;hidden&quot; name=&quot;wpp_data[meta][manual_coordinates]&quot; value=&quot;false&quot;/&gt;
          &lt;input type=&quot;checkbox&quot; id=&quot;wpp_manual_coordinates&quot; name=&quot;wpp_data[meta][manual_coordinates]&quot; value=&quot;true&quot; &lt;?php checked( $object[ &#x27;manual_coordinates&#x27; ], 1 ); ?&gt; /&gt;
          &lt;label for=&quot;wpp_manual_coordinates&quot;&gt;&lt;?php echo __( &#x27;Set Coordinates Manually.&#x27;, &#x27;wpp&#x27; ); ?&gt;&lt;/label&gt;
          &lt;div id=&quot;wpp_coordinates&quot; style=&quot;&lt;?php if( !$object[ &#x27;manual_coordinates&#x27; ] ) { ?&gt;display:none;&lt;?php } ?&gt;&quot;&gt;
            &lt;ul&gt;
              &lt;li&gt;
                  &lt;input type=&quot;text&quot; id=&quot;wpp_meta_latitude&quot; name=&quot;wpp_data[meta][latitude]&quot; value=&quot;&lt;?php echo $object[ &#x27;latitude&#x27; ]; ?&gt;&quot;/&gt;
                  &lt;label&gt;&lt;?php echo __( &#x27;Latitude&#x27;, &#x27;wpp&#x27; ) ?&gt;&lt;/label&gt;
                  &lt;div class=&quot;wpp_clear&quot;&gt;&lt;/div&gt;
                &lt;/li&gt;
                &lt;li&gt;
                  &lt;input type=&quot;text&quot; id=&quot;wpp_meta_longitude&quot; name=&quot;wpp_data[meta][longitude]&quot; value=&quot;&lt;?php echo $object[ &#x27;longitude&#x27; ]; ?&gt;&quot;/&gt;
                  &lt;label&gt;&lt;?php echo __( &#x27;Longitude&#x27;, &#x27;wpp&#x27; ) ?&gt;&lt;/label&gt;
                  &lt;div class=&quot;wpp_clear&quot;&gt;&lt;/div&gt;
                &lt;/li&gt;
              &lt;/ul&gt;
          &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;script type=&quot;text/javascript&quot;&gt;

      jQuery( document ).ready( function() {

        jQuery( &#x27;input#wpp_manual_coordinates&#x27; ).change( function() {

          var use_manual_coordinates;

          if( jQuery( this ).is( &quot;:checked&quot; ) ) {
            use_manual_coordinates = true;
            jQuery( &#x27;#wpp_coordinates&#x27; ).show();

          } else {
            use_manual_coordinates = false;
            jQuery( &#x27;#wpp_coordinates&#x27; ).hide();
          }

        } );

      } );

    &lt;/script&gt;
  &lt;?php

  $content = ob_get_contents();
  ob_end_clean();

  return $content;
}

/**
 * Updates numeric and currency attribute of parent property on child property saving.
 * Sets attribute&#x27;s value based on children values ( sets aggregated value ).
 *
 * @param integer $post_id
 *
 * @return null
 * @used Utility::save_property();
 * @author peshkov@UD
 */
function wpp_save_property_aggregated_data( $post_id ) {
  global $wpdb, $wp_properties;

  if( empty( $_REQUEST[ &#x27;parent_id&#x27; ] ) ) {
    return null;
  }

  //** Get children */
  $children = $wpdb-&gt;get_col( $wpdb-&gt;prepare( &quot;
    SELECT ID
      FROM {$wpdb-&gt;posts}
        WHERE  post_type = &#x27;property&#x27;
        AND post_status = &#x27;publish&#x27;
        AND post_parent = %s
          ORDER BY menu_order ASC
  &quot;, $_REQUEST[ &#x27;parent_id&#x27; ] ) );

  if( count( $children ) &gt; 0 ) {

    $range = array();

    //** Cycle through children and get necessary variables */
    foreach( $children as $child_id ) {

      $child_object = Utility::get_property( $child_id, &quot;load_parent=false&quot; );

      //** Exclude variables from searchable attributes (to prevent ranges) */
      $excluded_attributes    = $wp_properties[ &#x27;geo_type_attributes&#x27; ];
      $excluded_attributes[ ] = $wp_properties[ &#x27;configuration&#x27; ][ &#x27;address_attribute&#x27; ];

      foreach( $wp_properties[ &#x27;searchable_attributes&#x27; ] as $searchable_attribute ) {

        $attribute_data = Utility::get_attribute_data( $searchable_attribute );

        if( $attribute_data[ &#x27;numeric&#x27; ] || $attribute_data[ &#x27;currency&#x27; ] ) {
          if( !empty( $child_object[ $searchable_attribute ] ) &amp;&amp; !in_array( $searchable_attribute, $excluded_attributes ) ) {
            if( !isset( $range[ $searchable_attribute ] ) ) $range[ $searchable_attribute ] = array();
            $range[ $searchable_attribute ][ ] = $child_object[ $searchable_attribute ];
          }

        }
      }
    }

    foreach( $range as $range_attribute =&gt; $range_values ) {
      //* Cycle through all values of this range (attribute), and fix any ranges that use dashes */
      foreach( $range_values as $key =&gt; $single_value ) {
        //* Remove dollar signs */
        $single_value = str_replace( &quot;$&quot;, &#x27;&#x27;, $single_value );
        //* Fix ranges */
        if( strpos( $single_value, &#x27;&amp;ndash;&#x27; ) ) {
          $split = explode( &#x27;&amp;ndash;&#x27;, $single_value );
          foreach( $split as $new_single_value ) {
            if( !empty( $new_single_value ) ) {
              array_push( $range_values, trim( $new_single_value ) );
            }
          }
          //* Unset original value with dash */
          unset( $range_values[ $key ] );
        }
      }

      $average = isset( $wp_properties[ &#x27;configuration&#x27; ][ &#x27;show_aggregated_value_as_average&#x27; ] ) ? $wp_properties[ &#x27;configuration&#x27; ][ &#x27;show_aggregated_value_as_average&#x27; ] : false;

      $val = @array_sum( $range_values );
      $val = is_numeric( $val ) &amp;&amp; $val &gt; 0 ? ( $average == &#x27;true&#x27; ? ceil( $val / count( $range_values ) ) : $val ) : 0;

      update_post_meta( $_REQUEST[ &#x27;parent_id&#x27; ], $range_attribute, $val );

    }

  }

}

function wpp_stat_filter_for_rent_fix( $value ) {
  if( $value == &#x27;1&#x27; )
    return __( &#x27;Yes&#x27;, &#x27;wpp&#x27; );
}

function wpp_stat_filter_for_sale_fix( $value ) {
  if( $value == &#x27;1&#x27; )
    return __( &#x27;Yes&#x27;, &#x27;wpp&#x27; );
}

/**
 * Formats phone number for display
 *
 *
 * @since 1.0
 *
 * @param string $phone_number
 *
 * @return string $phone_number
 */
function format_phone_number( $phone_number ) {
  global $wp_properties;

  if( $wp_properties[ &#x27;configuration&#x27; ][ &#x27;property_overview&#x27; ][ &#x27;format_phone_number&#x27; ] == &#x27;true&#x27; ) {
    $phone_number = preg_replace( &quot;[^0-9]&quot;, &#x27;&#x27;, $phone_number );
    if( strlen( $phone_number ) != 10 ) {
      return $phone_number;
    }
    $sArea        = substr( $phone_number, 0, 3 );
    $sPrefix      = substr( $phone_number, 3, 3 );
    $sNumber      = substr( $phone_number, 6, 4 );
    $phone_number = &quot;(&quot; . $sArea . &quot;) &quot; . $sPrefix . &quot;-&quot; . $sNumber;
  }

  return $phone_number;
}

/**
 * Adds option &#x27;format phone number&#x27; to settings of property page
 */
function add_format_phone_number_checkbox() {
  global $wp_properties;
  echo &#x27;&lt;li&gt;&#x27; . Utility::checkbox( &quot;name=wpp_settings[configuration][property_overview][format_phone_number]&amp;label=&quot; . __( &#x27;Format phone number.&#x27;, &#x27;wpp&#x27; ), $wp_properties[ &#x27;configuration&#x27; ][ &#x27;property_overview&#x27; ][ &#x27;format_phone_number&#x27; ] ) . &#x27;&lt;/li&gt;&#x27;;
}

/**
 * Adds option &#x27;format phone number&#x27; to settings of property page
 *
 * @since 1.16.2
 *
 */
function add_format_true_checkbox() {
  global $wp_properties;
  echo &#x27;&lt;li&gt;&#x27; . Utility::checkbox( &quot;name=wpp_settings[configuration][property_overview][format_true_checkbox]&amp;label=&quot; . __( &#x27;Convert &quot;Yes&quot; and &quot;True&quot; values to checked icons on the front-end.&#x27;, &#x27;wpp&#x27; ), $wp_properties[ &#x27;configuration&#x27; ][ &#x27;property_overview&#x27; ][ &#x27;format_true_checkbox&#x27; ] ) . &#x27;&lt;/li&gt;&#x27;;
}

/**
 * Add &quot;city&quot; as an inheritable attribute for city property_type
 *
 * Modifies $wp_properties[&#x27;property_inheritance&#x27;] in Utility::settings_action(), overriding database settings
 *
 * @since 1.0
 *
 * @param array $property_inheritance
 *
 * @return array $property_inheritance
 */
function add_city_to_inheritance( $property_inheritance ) {

  $property_inheritance[ &#x27;floorplan&#x27; ][ ] = &#x27;city&#x27;;

  return $property_inheritance;
}

/**
 * Adds city to searchable
 *
 * Modifies $wp_properties[&#x27;searchable_attributes&#x27;] in Utility::settings_action(), overriding database settings
 *
 * @since 1.0
 *
 * @param $array
 *
 * @internal param string $area
 *
 * @return string $area
 */
function add_city_to_searchable( $array ) {

  global $wp_properties;

  /** Determine if property attribute &#x27;city&#x27; already exists, we don&#x27;t need to set searchable here */
  if( empty( $wp_properties[ &#x27;property_stats&#x27; ] ) ) {
    if( is_array( $array ) &amp;&amp; !in_array( &#x27;city&#x27;, $array ) ) {
      array_push( $array, &#x27;city&#x27; );
    }
  }

  return $array;
}

/**
 * Adds &quot;sq. ft.&quot; to the end of all area attributes
 *
 *
 * @since 1.0
 *
 * @param string $area
 *
 * @return string $area
 */
function add_square_foot( $area ) {
  return $area . __( &quot; sq. ft.&quot;, &#x27;wpp&#x27; );
}

/**
 * Demonstrates how to add a new attribute to the property class
 *
 * @since 1.08
 * @uses Utility::get_coordinates() Creates an array from string $args.
 *
 * @param $property
 *
 * @return
 * @internal param string $listing_id Listing ID must be passed
 */
function add_display_address( $property ) {
  global $wp_properties;

  // Don&#x27;t execute function if coordinates are set to manual
  if( isset( $property[ &#x27;manual_coordinates&#x27; ] ) &amp;&amp; $property[ &#x27;manual_coordinates&#x27; ] == &#x27;true&#x27; )
    return $property;

  $display_address = $wp_properties[ &#x27;configuration&#x27; ][ &#x27;display_address_format&#x27; ];

  if( empty( $display_address ) ) {
    $display_address = &quot;[street_number] [street_name], [city], [state]&quot;;
  }

  $display_address_code = $display_address;

  // Check if property is supposed to inehrit the address
  if( isset( $property[ &#x27;parent_id&#x27; ] )
    &amp;&amp; is_array( $wp_properties[ &#x27;property_inheritance&#x27; ][ $property[ &#x27;property_type&#x27; ] ] )
    &amp;&amp; in_array( $wp_properties[ &#x27;configuration&#x27; ][ &#x27;address_attribute&#x27; ], $wp_properties[ &#x27;property_inheritance&#x27; ][ $property[ &#x27;property_type&#x27; ] ] )
  ) {

    if( get_post_meta( $property[ &#x27;parent_id&#x27; ], &#x27;address_is_formatted&#x27;, true ) ) {
      $street_number = get_post_meta( $property[ &#x27;parent_id&#x27; ], &#x27;street_number&#x27;, true );
      $route         = get_post_meta( $property[ &#x27;parent_id&#x27; ], &#x27;route&#x27;, true );
      $city          = get_post_meta( $property[ &#x27;parent_id&#x27; ], &#x27;city&#x27;, true );
      $state         = get_post_meta( $property[ &#x27;parent_id&#x27; ], &#x27;state&#x27;, true );
      $state_code    = get_post_meta( $property[ &#x27;parent_id&#x27; ], &#x27;state_code&#x27;, true );
      $postal_code   = get_post_meta( $property[ &#x27;parent_id&#x27; ], &#x27;postal_code&#x27;, true );
      $county        = get_post_meta( $property[ &#x27;parent_id&#x27; ], &#x27;county&#x27;, true );
      $country       = get_post_meta( $property[ &#x27;parent_id&#x27; ], &#x27;country&#x27;, true );

      $display_address = str_replace( &quot;[street_number]&quot;, $street_number, $display_address );
      $display_address = str_replace( &quot;[street_name]&quot;, $route, $display_address );
      $display_address = str_replace( &quot;[city]&quot;, &quot;$city&quot;, $display_address );
      $display_address = str_replace( &quot;[state]&quot;, &quot;$state&quot;, $display_address );
      $display_address = str_replace( &quot;[state_code]&quot;, &quot;$state_code&quot;, $display_address );
      $display_address = str_replace( &quot;[country]&quot;, &quot;$country&quot;, $display_address );
      $display_address = str_replace( &quot;[county]&quot;, &quot;$county&quot;, $display_address );
      $display_address = str_replace( &quot;[zip_code]&quot;, &quot;$postal_code&quot;, $display_address );
      $display_address = str_replace( &quot;[zip]&quot;, &quot;$postal_code&quot;, $display_address );
      $display_address = str_replace( &quot;[postal_code]&quot;, &quot;$postal_code&quot;, $display_address );
      $display_address = preg_replace( &#x27;/^\n+|^[\t\s]*\n+/m&#x27;, &quot;&quot;, $display_address );
      $display_address = nl2br( $display_address );

    }
  } else {

    // Verify that address has been converted via Google Maps API
    if( $property[ &#x27;address_is_formatted&#x27; ] ) {

      $street_number = $property[ &#x27;street_number&#x27; ];
      $route         = $property[ &#x27;route&#x27; ];
      $city          = $property[ &#x27;city&#x27; ];
      $state         = $property[ &#x27;state&#x27; ];
      $state_code    = $property[ &#x27;state_code&#x27; ];
      $country       = $property[ &#x27;country&#x27; ];
      $postal_code   = $property[ &#x27;postal_code&#x27; ];
      $county        = $property[ &#x27;county&#x27; ];

      $display_address = str_replace( &quot;[street_number]&quot;, $street_number, $display_address );
      $display_address = str_replace( &quot;[street_name]&quot;, $route, $display_address );
      $display_address = str_replace( &quot;[city]&quot;, &quot;$city&quot;, $display_address );
      $display_address = str_replace( &quot;[state]&quot;, &quot;$state&quot;, $display_address );
      $display_address = str_replace( &quot;[state_code]&quot;, &quot;$state_code&quot;, $display_address );
      $display_address = str_replace( &quot;[country]&quot;, &quot;$country&quot;, $display_address );
      $display_address = str_replace( &quot;[county]&quot;, &quot;$county&quot;, $display_address );
      $display_address = str_replace( &quot;[zip_code]&quot;, &quot;$postal_code&quot;, $display_address );
      $display_address = str_replace( &quot;[zip]&quot;, &quot;$postal_code&quot;, $display_address );
      $display_address = str_replace( &quot;[postal_code]&quot;, &quot;$postal_code&quot;, $display_address );
      $display_address = preg_replace( &#x27;/^\n+|^[\t\s]*\n+/m&#x27;, &quot;&quot;, $display_address );
      $display_address = nl2br( $display_address );

    }

  }

  // If somebody is smart enough to do the following with regular expressions, let us know!

  $comma_killer = explode( &quot;,&quot;, $display_address );

  if( is_array( $comma_killer ) )
    foreach( $comma_killer as $key =&gt; $addy_line )
      if( isset( $addy_line ) )
        if( trim( $addy_line ) == &quot;&quot; )
          unset( $comma_killer[ $key ] );

  $display_address = implode( &quot;, &quot;, $comma_killer );

  $empty_line_killer = explode( &quot;&lt;br /&gt;&quot;, $display_address );

  if( is_array( $empty_line_killer ) )
    foreach( $empty_line_killer as $key =&gt; $addy_line )
      if( isset( $addy_line ) )
        if( trim( $addy_line ) == &quot;&quot; )
          unset( $empty_line_killer[ $key ] );

  if( is_array( $empty_line_killer ) ) {
    $display_address = implode( &quot;&lt;br /&gt;&quot;, $empty_line_killer );
  }

  $property[ &#x27;display_address&#x27; ] = apply_filters( &#x27;wpp_display_address&#x27;, $display_address, $property );

  // Don&#x27;t return if result matches the
  if( str_replace( array( &quot; &quot;, &quot;,&quot;, &quot;\n&quot; ), &quot;&quot;, $display_address_code ) == str_replace( array( &quot; &quot;, &quot;,&quot;, &quot;\n&quot; ), &quot;&quot;, $display_address ) ) {
    $property[ &#x27;display_address&#x27; ] = &quot;&quot;;
  }

  //** Make sure that address isn&#x27;t retunred with no data */
  if( str_replace( &#x27;,&#x27;, &#x27;&#x27;, $property[ &#x27;display_address&#x27; ] ) == &#x27;&#x27; ) {
    /* No Address */
  }

  return $property;
}

/**
 * Demonstrates how to add dollar signs before all prices and deposits
 *
 * @since 1.15.3
 * @uses Utility::get_coordinates() Creates an array from string $args.
 *
 * @param $content
 *
 * @internal param string $listing_id Listing ID must be passed
 *
 * @return mixed|string
 */
function add_dollar_sign( $content ) {
  global $wp_properties;

  $currency_symbol           = ( !empty( $wp_properties[ &#x27;configuration&#x27; ][ &#x27;currency_symbol&#x27; ] ) ? $wp_properties[ &#x27;configuration&#x27; ][ &#x27;currency_symbol&#x27; ] : &quot;$&quot; );
  $currency_symbol_placement = ( !empty( $wp_properties[ &#x27;configuration&#x27; ][ &#x27;currency_symbol_placement&#x27; ] ) ? $wp_properties[ &#x27;configuration&#x27; ][ &#x27;currency_symbol_placement&#x27; ] : &quot;before&quot; );

  $content = trim( str_replace( array( &quot;$&quot;, &quot;,&quot; ), &quot;&quot;, $content ) );

  if( !is_numeric( $content ) ) {
    return preg_replace_callback( &#x27;/(\d+)/&#x27;, create_function(
      &#x27;$matches&#x27;,
      &#x27;return add_dollar_sign( $matches[0] );&#x27;
    ), $content );
  } else {
    return ( $currency_symbol_placement == &#x27;before&#x27; ? $currency_symbol : &#x27;&#x27; ) . Utility::format_numeric( $content ) . ( $currency_symbol_placement == &#x27;after&#x27; ? $currency_symbol : &#x27;&#x27; );
  }
}

/**
 * Display latitude and longitude on listing edit page below address field
 *
 * Echos html content to be displayed after location attribute on property edit page
 *
 * @since 1.0
 * @uses Utility::get_coordinates() Creates an array from string $args.
 *
 * @param bool|string $listing_id Listing ID must be passed
 */
function wpp_show_coords( $listing_id = false ) {

  if( !$listing_id )
    return;

  // If latitude and logitude meta isn&#x27;t set, returns false
  $coords = Utility::get_coordinates( $listing_id );

  echo &quot;&lt;span class=&#x27;description&#x27;&gt;&quot;;
  if( $coords ) {
    _e( &quot;Address was validated by Google Maps.&quot;, &#x27;wpp&#x27; );
  } else {
    _e( &quot;Address has not yet been validated, should be formatted as: street, city, state, postal code, country. Locations are validated through Google Maps.&quot;, &#x27;wpp&#x27; );
  }
  echo &quot;&lt;/span&gt;&quot;;

}

/**
 * Add week/month dropdown after price
 *
 * Displays a hidden field on property edit page setting the property price frequency
 *
 * @since 1.0
 *
 * @param bool|string $listing_id Listing ID must be passed
 */
function wpp_show_week_month_selection( $listing_id = false ) {
  if( !$listing_id )
    return;

  echo &#x27;&lt;input type=&quot;hidden&quot; name=&quot;wpp_data[meta][price_per]&quot; value=&quot;month&quot; /&gt;&#x27;;

  /*

  Uncomment the following to allow the editor to select if price is monthly and weekly.
  Or add your own frequencies.

    &lt;select id=&quot;wpp_meta_price_per&quot; name=&quot;wpp_data[meta][price_per]&quot;&gt;
      &lt;option value=&quot;&quot;&gt;&lt;/option&gt;
      &lt;option &lt;?php if(get_post_meta($listing_id, &#x27;price_per&#x27;, true) == &#x27;week&#x27;) echo &quot;SELECTED&quot;; ?&gt; value=&quot;week&quot;&gt;week&lt;/option&gt;
      &lt;option &lt;?php if(get_post_meta($listing_id, &#x27;price_per&#x27;, true) == &#x27;month&#x27;) echo &quot;SELECTED&quot;; ?&gt; value=&quot;month&quot;&gt;month&lt;/option&gt;
    &lt;/select&gt;.
  */
}

/**
 *
 * Group search values
 *
 */
function group_search_values( $values ) {
  $result = array();

  if( !is_array( $values ) ) {
    return $values;
  }

  $min     = 0;
  $max     = 0;
  $control = false;

  for( $i = 0; $i &lt; count( $values ); $i++ ) {
    $value = (int) $values[ $i ];
    if( !$control &amp;&amp; $min == 0 &amp;&amp; $value != 0 ) {
      $control = true;
      $min     = $value;
    } elseif( $value &lt; $min ) {
      $min = $value;
    } elseif( $value &gt; $max ) {
      $max = $value;
    }
  }

  $range = $max - $min;

  if( $range == 0 ) {
    return $values;
  }

  $s      = round( $range / 10 );
  $stepup = ( $s &gt; 1 ) ? $s : 1;

  $result[ ] = $min;
  for( $i = ( $min + $stepup ); $i &lt; $max; $i ) {
    $result[ ] = $i;
    $i         = $i + $stepup;
  }
  $result[ ] = $max;

  return $result;
}

/**
 * Exclude Hidden Property Atributes from data to don&#x27;t show them on frontend
 *
 * @param array $property
 *
 * @return array $property
 */
function wpp_exclude_hidden_attributes( $property ) {
  global $wp_properties;

  if( !current_user_can( &#x27;manage_options&#x27; ) ) {
    foreach( $property as $slug =&gt; $value ) {
      // Determine if the attribute is hidden for frontend
      if( in_array( $slug, (array) $wp_properties[ &#x27;hidden_frontend_attributes&#x27; ] ) ) {
        unset( $property[ $slug ] );
      }
    }
  }

  return $property;
}


    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
